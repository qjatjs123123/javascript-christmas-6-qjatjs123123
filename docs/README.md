# 🚀 요구사항 분석
```
1. `사용자(Customer)`는 `이벤트 플래너(EventPlanner)`를 통해 날짜를 입력할 수 있다.
  - '/api/dateValidation/'을 호출한다. 
  - 실패하면 `httpResponse`의 status값을 'error'한다. 클라이언트에서는 다시 입력받는다.
  - 성공하면 `httpResponse`의 status값을 'sucess'한다. 클라이언트는 다음 로직을 실행한다.

2. 사용자(Customer)는 이벤트 플래너(EventPlanner)를 통해 메뉴, 개수를 입력할 수 있다.
  - '/api/orderMenuAndCount'를 호출한다.
  - 에러가 발생하면 `httpResponse`의 status값을 'error'한다. 클라이언트에서는 다시 입력받는다.
  - 성공하면 `httpResponse`의 status값을 'sucess'한다. 클라이언트는 다음 로직을 실행한다.

3. 사용자(Customer)는 이벤트 플래너(EventPlanner)를 통해 이벤트 할인 결과를 요청할 수 있다.
 - '/api/getResultDiscountInfo'를 호출한다.
 - 이벤트 컨트롤러(EventController)에서 결과값을 UserDTO에 담아 'HttpResponse'를 통해 반환한다.
 - 결과값을 보여준다.

4. 이벤트 컨트롤러(EventController)에서 달력(Calender)를 통해 년월일 계산 후 특정 이벤트 여부를 확인할 수 있다.
5. 이벤트 컨트롤러(EventController)에서 크리스마스 디데이 할인(ChristmasDdayDiscount) 통해 얼만큼 할인 되었는지 알 수 있다.
6. 이벤트 컨트롤러(EventController)에서 평일할인(WeekdayDiscount) 통해 할인 되었는지 알 수 있다.
7. 이벤트 컨트롤러(EventController)에서 주말할인(WeekendDiscount) 통해 얼만큼 할인 되었는지 알 수 있다.
8. 이벤트 컨트롤러(EventController)에서 특별할인(SpecialDiscount) 통해 얼만큼 할인 되었는지 알 수 있다.
10. 이벤트 컨트롤러(EventPlanner)는 증정이벤트(FreeGiftEvent) 통해 샴페인 증정 받을 수 있다.
11. 이벤트 컨트롤러(EventPlanner)는 이벤트배지(EventBadge) 통해 이벤트배지 증정 받을 수 있다.

```


# 🐱‍🐉 핵심기능
## 📌 다양한 할인 이벤트를 진행한다.
### 크리스마스 디데이 할인 => 총주문 금액에서 해당 금액만큼 할인이 되어야 한다.
  - [x] : 총 주문 금액이 10000원 이상이여야지 할인이 진행되어야 한다.
  - [x] : 이벤트 기간: 2023.12.1 ~ 2023.12.25 이여야 한다.
    - [x] : 입력한 날짜를 체크하여 12월 1일 ~ 12월 25일 사이인지 확인한다.

  - [x] : 시작일인 12월 1일엔 1000으로 시작하여 12월 2일엔 1100, 마지막 12월 25일엔 3400원이 할인 된다. (크리스마스가 다가올 수록 100식 증가한다.)

### 평일 할인 (일 ~ 목) => 일, 월, 화, 수, 목 요일에는 디저트 메뉴 1개당 2023 할인되어야 한다.
  - [x] : 총 주문 금액이 10000원 이상이여야지 할인이 진행되어야 한다.
  - [x] : 이벤트 기간은: 2023.12.1 ~ 2023.12.31 이여야 한다.
  - [x] : 일, 월, 화, 수, 목 요일인지 확인한다.
  - [x] : 평일(일 ~ 목)에는 디저트 메뉴를 개당 2023원 할인 한다.

### 주말 할인(금, 토) => 금, 토 요일에는 메인 메뉴를 메뉴 1개당 2023원 할인되어야 한다.
  - [x] : 총 주문 금액이 10000원 이상이여야지 할인이 진행되어야 한다.
  - [x] : 이벤트 기간은: 2023.12.1 ~ 2023.12.31 이여야 한다.
  - [x] : 금, 토 요일인지 확인한다.
  - [x] : 주말에는 메인 메뉴를 개당 2023원 할인 한다.

### 특별 할인 : 이벤트 달력에 별이 있으면 총주문 금액에서 1000원을 할인한다.
  - [x] : 총 주문 금액이 10000원 이상이여야지 할인이 진행되어야 한다.
  - [x] : 이벤트 기간은: 2023.12.1 ~ 2023.12.31 이여야 한다.
  - [x] : 별이 있는 날은 default로 12월 3일, 10일 17일, 24일, 25일, 31일로 지정한다.
  - [x] : 입력한 날짜를 체크하여 별이 있는 날인지 확인한다.
  - [x] : 해당 날에는 총 주문 금액에서 1000을 할인한다.

### 증정 이벤트 : 할인 전 총주문 금액이 12만원 이상일 때, 샴페인 1개를 증정한다.
  - [x] : 총 주문 금액이 10000원 이상이여야지 할인이 진행되어야 한다.
  - [x] : 이벤트 기간은: 2023.12.1 ~ 2023.12.31 이여야 한다.
  - [x] : 할인 하기전 총 주문 금액이 12만원 이상인지 확인한다.
  - [x] : 이상이면 샴페인 1개를 증정한다.

### 이벤트 뱃지 : 총혜택 금액에 따라 다른 이벤트 배지를 부여한다.
  - [x] : 총 주문 금액이 10000원 이상이여야지 할인이 진행되어야 한다.
  - [x] : 할인 금액의 합계 + 증정 메뉴의 가격을 계산한다.
    - [x] : 5 천원 이상이면 별을 부여한다.
    - [x] : 1만원 이상이면 트리를 부여한다.
    - [x] : 2만원 이상이면 산타를 부여한다.

## 📌 입력
### 방문 일자를 입력받는다.
` bash
12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
`
  - [x] : 방문할 날짜가 1이상 31이하인지 확인한다.

### 주문할 메뉴와 개수를 입력받는다.
` bash
주문하실 메뉴를 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
`
  - [x] : 메뉴판에 없는 메뉴이면 에러를 발생한다.
  - [x] : 메뉴의 개수는 1이상이 아니면 에러를 발생한다.
  - [x] : 메뉴의 형식이 예시와 다를 경우 에러 메시지를 입력한다.
  - [x] : 중복메뉴를 입력하면 에러 메시지를 보여준다.
  - [x] : 음료만 주문시 에러를 발생한다.
  - [x] : 메뉴는 최대 20개를 넘어가면 에러를 발생한다.

## 📌 출력
### 주문메뉴를 출력한다.
- [x] : 순서와 상관없이 주문메뉴를 출력한다.

### 할인 전 총주문 금액을 출력한다.
- [x] : 할인 전 총 주문금액은 할인을 하지 않은 순순한 해당 가격을 더한 값을 출력한다.

### 증정 메뉴 출력한다.
- [x] : 증정메뉴가 있으면 출력하고 없으면 없음을 출력한다.
 
### 혜택 내역 출력한다.
- [x] : 고객의 적용된 이벤트 내역만 보여준다.
- [x] : 이벤트 할인 금액을 마이너스 형태로 보여준다.
- [x] : 적용된 혜택이 없으면 없음을 출력한다.

### 총 혜택 금액을 출력한다.
- [x] : 총 혜택 금액은 혜택 내역에서 모든 할인 가격을 합친 결과를 출력한다.
- [x] : 마이너스 형태로 보여준다.
- [x] : 없으면 없음을 출력한다.

### 할인 후 예상 결제 금액 출력한다.
- [x] : 할인 전 총주문 금액 - (총혜택금액 - 증정 이벤트 금액) 값을 출력한다.
- [x] : 없으면 없음을 출력한다.

### 12월 이벤트 배지를 출력한다.
- [x] : 적용된 이벤트 배지를 출력한다.
- [x] : 없으면 없음을 출력한다.


# ⚙️ 설계
## 🔒 설계 배경
### 도메인 주도 설계(DDD) 이유
```
3주차 미션을 진행할 때 도메인 로직에 단위 테스트를 구현해야 한다는 조건이 있었다.
4주차 미션때에는 도메인 주도 설계(DDD)를 통해서 설계한다면 테스트도 자연스럽게 도메인 로직에 단위 테스트가 될 것이라고 생각했다. 
```
### spring에서 DTO개념 도입 이유
```
3주차에서 스프링의 동작과정을 미션에 녹여냈었는데 이번에는 Spring에서 DTO개념을 도입하였다. 
클라이언트, 서버 개념으로 보았을 때 자연스럽게 다중 사용자 관점에서도 생각을 하게되었다. 
도메인 로직 맴버 변수에 값들을 저장한다면 다중 사용자가 사용했을 때  race condition(경쟁상태)가 발생되어 예기치 못한 오류가 발생할 것이라고 생각했다. 
그래서 사용자마다 userDTO를 생성하여 그 DTO를 각 레이어 층에서 사용한다면 될 것이라고 생각했다.
```
### Domain에서 싱글턴을 사용한 이유
```
도메인 로직 객체들이 싱글톤으로 구현된 이유는 스프링 빈의 개념과 관련이 있다. 
도메인 로직은 일반적으로 엔티티로 간주되며, 스프링에서는 빈으로 등록된 객체에 대해 기본적으로 싱글톤 스코프를 가지도록 설정되기 때문에 
개념을 동일하게 가져가기 위해서 싱글턴으로 구현하였다.
```

### HttpRequest, HttpResponse 사용 이유
```
서버와 클라이언트간에 메시지를 송수신하기 위해서 Http 프로토콜을 사용하는 개념을 녹여보았다. 여기서 HttpRequest, HttpResponse를 class로 만들어서 new로 새로운 객체를 만들어 반환하도록 하였다.
```


## 🎯 Client, Server구조와 도메인 주도 설계(DDD)
### 요구사항 분석 바탕으로 도메인 분리
![image](https://github.com/qjatjs123123/Algorithm/assets/74814641/5b893480-7530-4bdb-a585-b2486403e097)

### 도메인을 하위 도메인으로 분리
![image](https://github.com/qjatjs123123/Algorithm/assets/74814641/bf80bc07-14ed-4450-858c-bfdb5f063256)

### 애그리거트 다이어그램
![image](https://github.com/qjatjs123123/Algorithm/assets/74814641/783e0518-e992-4417-b706-461b92d282c8)

### 흐름도
![image](https://github.com/qjatjs123123/Algorithm/assets/74814641/44ba93a5-ffcc-49de-8dce-01fbbaaee136)

# ⚙️ 테스트 설계
## 📌 UserDTO 테스트
### 유효성 검증
- [x] : 입력받은 날짜가 정상적으로 저장되는지 확인한다.
  - [x] : 공백을 입력할 경우 에러가 발생한다.
  - [x] : 문자를 입력할 경우 에러가 발생한다.
  - [x] : 1~31 범위의 숫자가 아닌 경우 에러가 발생한다.

- [x] : 입력받은 메뉴가 정상적으로 저장되는지 확인한다.
  - [x] : '메뉴이름-개수'형태가 아니면 에러를 출력한다.
  - [x] : 메뉴판에 존재하는 메뉴가 아니면 에러를 출력한다.
  - [x] : 메뉴가 중복되어 입력되면 에러를 출력한다.
  - [x] : 음료만 주문시 에러를 출력한다.
  - [x] : 메뉴 개수가 총 20개를 넘으면 에러를 출력한다.
  - [x] : 메뉴의 개수는 1이상이 아니면 에러를 출력한다.

## 📌 Calendar 테스트
### 크리스마스 디데이 할인 여부
- [x] : 입력받은 날짜가 크리스마스 디데이인지 확인한다.
- [x] : 입력받은 날짜가 크리스마스 디에이가 아닌지 확인한다.

### 평일 할인(일요일~목요일) 할인 여부
- [x] : 입력받은 날짜가 평일 할인(일요일~목요일)인지 확인한다.
- [x] : 입력받은 날짜가 평일 할인(일요일~목요일)가 아닌지 확인한다.

### 주말 할인(금요일, 토요일) 할인 여부
- [x] : 입력받은 날짜가 주말 할인(금요일, 토요일)인지 확인한다.
- [x] : 입력받은 날짜가 주말 할인(금요일, 토요일)가 아닌지 확인한다.

### 특별 할인 할인 여부
- [x] : 입력받은 날짜가 특별 할인 인지 확인한다.
- [x] : 입력받은 날짜가 특별 할인 아닌지 확인한다.

## 📌 ChristmasDdayDiscout 테스트
- [x] : 크리스마스 디데이는 1,000원으로 시작하여 크리스마스가 다가올수록 날마다 할인 금액이 100원씩 증가한다.

## 📌 WeekdayDiscount 테스트
- [x] : 평일에 디저트 메뉴를 메뉴 1개당 2023원 할인되는지 확인한다.

## 📌 WeekendDiscount 테스트
- [x] : 주말에 메인 메뉴를 메뉴 1개당 2023원 할인되는지 확인한다.

## 📌 SpecialDiscount 테스트
- [x] : 이벤트 달력에 별이 있으면 총 주문 금액에서 1000원 할인되는지 확인한다.
- [x] : 별이 없다면 이벤트가 적용안되는지 확인한다.

## 📌 FreeGiftEvent 테스트
- [x] : 할인 전 총주문 금액이 12만원 이상일 때 증정품을 받는다.
- [x] : 할인 전 총주문 금액이 12만원 이하일 때 이벤트가 적용안되는지 확인한다.

## 📌 EventBadge 테스트
- [x] : 총 혜택 금액이 5천원 이상일 때 별인지 확인한다.
- [x] : 총 혜택 금액이 1만원 이상일 때 트리인지 확인한다.
- [x] : 총 혜택 금액이 2만원 이상일 때 산타인지 확인한다.
